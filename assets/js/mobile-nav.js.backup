// Mobile Navigation Toggle - Enhanced Version
document.addEventListener('DOMContentLoaded', function() {
    const mobileNavToggle = document.getElementById('mobile-nav-toggle');
    const mobileNavLinks = document.getElementById('mobile-nav-links');
    
    // Create overlay element
    const overlay = document.createElement('div');
    overlay.className = 'mobile-nav-overlay';
    overlay.id = 'mobile-nav-overlay';
    document.body.appendChild(overlay);
    
    if (mobileNavToggle && mobileNavLinks) {
        
        function openMenu() {
            mobileNavLinks.classList.add('show');
            overlay.classList.add('show');
            mobileNavToggle.setAttribute('aria-expanded', 'true');
            mobileNavToggle.innerHTML = '✕ Close';
            document.body.style.overflow = 'hidden';
        }
        
        function closeMenu() {
            mobileNavLinks.classList.remove('show');
            overlay.classList.remove('show');
            mobileNavToggle.setAttribute('aria-expanded', 'false');
            mobileNavToggle.innerHTML = '☰ Menu';
            document.body.style.overflow = '';
        }
        
        // Toggle menu on button click
        mobileNavToggle.addEventListener('click', function(e) {
            e.stopPropagation();
            const isExpanded = mobileNavLinks.classList.contains('show');
            
            if (isExpanded) {
                closeMenu();
            } else {
                openMenu();
            }
        });
        
        // Close menu when clicking overlay
        overlay.addEventListener('click', closeMenu);
        
        // Close menu when clicking outside
        document.addEventListener('click', function(event) {
            if (!mobileNavToggle.contains(event.target) && 
                !mobileNavLinks.contains(event.target) && 
                mobileNavLinks.classList.contains('show')) {
                closeMenu();
            }
        });
        
        // Close menu when clicking on a nav link and allow navigation
        const navLinks = mobileNavLinks.querySelectorAll('.nav-link');
        navLinks.forEach(link => {
            link.addEventListener('click', function(e) {
                // Don't prevent default behavior - let the link navigate
                closeMenu();
            });
        });
        
        // Handle window resize
        window.addEventListener('resize', function() {
            if (window.innerWidth > 768) {
                closeMenu();
            }
        });
        
        // Handle escape key
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape' && mobileNavLinks.classList.contains('show')) {
                closeMenu();
            }
        });
        
        // Initialize button state
        mobileNavToggle.setAttribute('aria-expanded', 'false');
        mobileNavToggle.innerHTML = '☰ Menu';
    }
});